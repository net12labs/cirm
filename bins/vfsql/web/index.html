<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VFSQL Web Interface</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ—‚ï¸ VFSQL Web Interface</h1>
            <p>Virtual File System backed by SQLite</p>
        </header>

        <div class="main-content">
            <!-- Volume/VFS Tree Panel -->
            <aside class="volume-sidebar">
                <div class="volume-panel">
                    <div class="panel-header">
                        <h3>ğŸ“š Volumes</h3>
                        <button onclick="showCreateVolumeDialog()" class="btn-icon" title="New Volume">â•</button>
                    </div>
                    <div class="volume-tree" id="volumeTree">
                        <div class="volume-item active" onclick="selectVolume('default')">
                            <span class="volume-icon">ğŸ’¾</span>
                            <span class="volume-name">default</span>
                            <button onclick="event.stopPropagation(); showCreateVFSDialog('default')" class="btn-tiny" title="New VFS">+</button>
                        </div>
                        <div class="vfs-list">
                            <div class="vfs-item active" onclick="selectVFS('default', 'default')">
                                <span class="vfs-icon">ğŸ“‚</span>
                                <span class="vfs-name">default</span>
                            </div>
                        </div>
                    </div>
                    <div class="current-context">
                        <small>ğŸ“ <span id="contextPath">default/default</span></small>
                    </div>
                </div>
            </aside>

            <!-- Sidebar with file tree -->
            <aside class="sidebar">
                <h2>File Browser</h2>
                <div class="toolbar">
                    <button onclick="createFile()" title="Create File">ğŸ“„ New File</button>
                    <button onclick="createFolder()" title="Create Folder">ğŸ“ New Folder</button>
                    <button onclick="testCreate()" title="Test File Creation">ğŸ§ª Test</button>
                    <button onclick="refreshTree()" title="Refresh">ğŸ”„ Refresh</button>
                </div>
                <div id="dropZone" class="drop-zone">
                    <div class="drop-zone-content">
                        <span class="drop-icon">ğŸ“</span>
                        <p>Drag & Drop files here</p>
                        <p class="drop-hint">or click to browse (multiple files supported)</p>
                        <input type="file" id="fileInput" multiple hidden>
                    </div>
                    <div class="drop-target-path">
                        Uploading to: <span id="uploadPath">/</span>
                    </div>
                </div>
                <div id="fileTree" class="file-tree"></div>
            </aside>

            <!-- Main content area -->
            <main class="content">
                <!-- Tabs -->
                <div class="tabs">
                    <button class="tab-btn active" onclick="showTab('editor')">Editor</button>
                    <button class="tab-btn" onclick="showTab('metadata')">Metadata</button>
                    <button class="tab-btn" onclick="showTab('variants')">Variants</button>
                    <button class="tab-btn" onclick="showTab('search')">Search</button>
                    <button class="tab-btn" onclick="showTab('events')">Events</button>
                </div>

                <!-- Editor Tab -->
                <div id="editor-tab" class="tab-content active">
                    <div class="editor-header">
                        <span id="currentFile" class="current-file">No file selected</span>
                        <div class="editor-actions">
                            <button onclick="uploadFiles()" id="uploadBtn">ğŸ“¤ Upload Files</button>
                            <button onclick="getCDNUrl()" id="cdnBtn" disabled>ğŸ”— Get CDN URL</button>
                            <button onclick="downloadFile()" id="downloadBtn" disabled>ğŸ“¥ Download</button>
                            <button onclick="saveFile()" id="saveBtn" disabled>ğŸ’¾ Save</button>
                            <button onclick="deleteFile()" id="deleteBtn" disabled>ğŸ—‘ï¸ Delete</button>
                        </div>
                    </div>
                    
                    <!-- Text Editor -->
                    <textarea id="editor" placeholder="Select a file or create a new one..."></textarea>
                    
                    <!-- Image Preview -->
                    <div id="imagePreview" class="image-preview hidden">
                        <img id="previewImage" alt="Image preview">
                        <div class="image-info">
                            <span id="imageSize"></span>
                            <span id="imageDimensions"></span>
                        </div>
                    </div>
                    
                    <!-- Binary File Info -->
                    <div id="binaryInfo" class="binary-info hidden">
                        <div class="binary-icon">ğŸ“¦</div>
                        <h3>Binary File</h3>
                        <p>This file cannot be edited in the browser.</p>
                        <div id="binaryDetails"></div>
                    </div>
                    
                    <!-- Upload Progress -->
                    <div id="uploadProgress" class="upload-progress hidden">
                        <div class="progress-header">
                            <span id="progressText">Uploading...</span>
                            <button onclick="cancelUpload()" class="btn-cancel">âœ•</button>
                        </div>
                        <div class="progress-bar">
                            <div id="progressFill" class="progress-fill"></div>
                        </div>
                        <div id="uploadDetails" class="upload-details"></div>
                    </div>
                </div>

                <!-- Metadata Tab -->
                <div id="metadata-tab" class="tab-content">
                    <h3>File Metadata</h3>
                    <div class="metadata-form">
                        <label>
                            Description:
                            <textarea id="metaDescription" rows="3" placeholder="Enter description..."></textarea>
                        </label>
                        <label>
                            Tags (comma-separated):
                            <input type="text" id="metaTags" placeholder="e.g., important, work, 2024">
                        </label>
                        <div class="tags-display" id="currentTags"></div>
                        <button onclick="saveMetadata()">Save Metadata</button>
                    </div>
                    <div class="file-info">
                        <h4>File Information</h4>
                        <div id="fileInfo"></div>
                    </div>
                </div>

                <!-- Variants Tab -->
                <div id="variants-tab" class="tab-content">
                    <h3>File Variants</h3>
                    <div class="variants-form">
                        <label>
                            Variant Name:
                            <input type="text" id="variantName" placeholder="e.g., thumbnail.jpg">
                        </label>
                        <label>
                            Content:
                            <textarea id="variantContent" rows="5" placeholder="Variant content..."></textarea>
                        </label>
                        <button onclick="createVariant()">Create Variant</button>
                    </div>
                    <div class="variants-list">
                        <h4>Existing Variants</h4>
                        <ul id="variantsList"></ul>
                    </div>
                </div>

                <!-- Search Tab -->
                <div id="search-tab" class="tab-content">
                    <h3>ğŸ” Search Files</h3>
                    <div class="search-form">
                        <label>
                            File Pattern:
                            <input type="text" id="searchPattern" placeholder="e.g., *.txt">
                        </label>
                        <label>
                            Path:
                            <input type="text" id="searchPath" value="/" placeholder="/">
                        </label>
                        <label>
                            Tags (comma-separated):
                            <input type="text" id="searchTags" placeholder="e.g., important, work">
                        </label>
                        <label>
                            Description contains:
                            <input type="text" id="searchDescription" placeholder="Search in descriptions...">
                        </label>
                        <label>
                            <input type="checkbox" id="searchRecursive" checked>
                            Recursive search
                        </label>
                        <button onclick="searchFiles()">ğŸ” Search</button>
                    </div>
                    <div class="search-results">
                        <h4>Results</h4>
                        <div id="searchResults"></div>
                    </div>
                </div>

                <!-- Events Tab -->
                <div id="events-tab" class="tab-content">
                    <h3>Real-time Events</h3>
                    <div class="events-controls">
                        <button onclick="toggleEvents()" id="eventsBtn">â–¶ï¸ Start Listening</button>
                        <button onclick="clearEvents()">ğŸ—‘ï¸ Clear</button>
                    </div>
                    <div id="eventsLog" class="events-log"></div>
                </div>
            </main>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
